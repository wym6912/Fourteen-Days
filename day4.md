## 第 4 天 并查集

第 4 天毛老师讲的是图论。我一想，这个东西不是我搞的，所以就没有去听。

[提高班第 3 天练习题\(增加\)](https://vjudge.net/contest/176236)

[提高班第 4 天练习题](#)

[提高班第 4 天练习题\(增加\)](https://vjudge.net/contest/209149) 六个月后增加

那么就开始今天的正题了。

### 1. 基础的并查集

并查集是一种用于分离集合操作的抽象数据类型。它所处理的是**集合**之间的关系，即动态地维护和处理集合元素之间复杂的关系，当给出两个元素的一个无序对\(a, b\)时，需要快速**合并 **a 和  b  分别所在的集合，这其间需要反复**查找**某元素所在的集合。“并”、“查”和“集”三字由此而来。在这种数据类型中， n 个不同的元素被分为若干组。每组是一个集合，这种集合叫做分离集合\(disjoint set\)。

并查集支持查找一个元素所属的集合以及两个元素各自所属的集合的合并。

例题：亲戚。给出最多`1000000`条信息 \($$m$$\)和询问\($$q$$\)，包括`20000`个人\($$n$$\)的信息。请判断各对人是否有关系。

用传统的思路，可以马上反应过来，对于输入的$$n$$个点$$m$$条边，找出连通块，然后进行判断。但这种实现思路首先必须保存$$m$$条边，然后再进行普通的遍历算法，效率显然不高。

在下图情况应该怎么处理？

![](/Pic_Day4_1.png)

用集合的思路，对于每个人建立一个集合，开始的时候集合元素是这个人本身，表示开始时不知道任何人是他的亲戚。以后每次给出一个亲戚关系时，就将两个集合合并。这样实时地得到了在当前状态下的集合关系。如果有提问，即在当前得到的结果中看两元素是否属于同一集合。

![](/PIC_Day4_2.png)

下图展示了并查集的基本操作。

![](/PIC_Day4_3.png)

![](/PIC_Day4_4.png)

由上图所说，这种算法的时间复杂度是$$O(n \alpha (n, n))$$，其中$$\alpha (n, n)$$是 Ackerman 函数的反函数，近似为常数。

